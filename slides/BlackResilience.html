<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Resilience Against Reverse Engineering and Tampering</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/dist/reset.css">
  <link rel="stylesheet" href="reveal.js/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: scroll;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: scroll; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #2a211c;
        color: #bdae9d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
    div.sourceCode
      { color: #bdae9d; background-color: #2a211c; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffff00; } /* Alert */
    code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #44aa43; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #049b0a; } /* Char */
    code span.cn { } /* Constant */
    code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
    code span.do { color: #0066ff; font-style: italic; } /* Documentation */
    code span.dt { text-decoration: underline; } /* DataType */
    code span.dv { color: #44aa43; } /* DecVal */
    code span.er { color: #ffff00; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #44aa43; } /* Float */
    code span.fu { color: #ff9358; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
    code span.op { } /* Operator */
    code span.pp { font-weight: bold; } /* Preprocessor */
    code span.sc { color: #049b0a; } /* SpecialChar */
    code span.ss { color: #049b0a; } /* SpecialString */
    code span.st { color: #049b0a; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #049b0a; } /* VerbatimString */
    code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
  </style>
  <link rel="stylesheet" href="reveal.js/dist/theme/../../../css/black.css" id="theme">
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Resilience Against Reverse Engineering and
Tampering</h1>
</section>

<section>
<section id="einleitung" class="title-slide slide level2">
<h2>Einleitung</h2>

</section>
<section id="übersicht" class="slide level3">
<h3>Übersicht</h3>
<div id="left">
<p>Maßnahmen wie Code-Verschleierung, Anti-Debugging, Anti-Manipulation
und Runtime Application Self-Protection (RASP) erhöhen die
Widerstandsfähigkeit einer App</p>
</div>
<div id="right">
<p><img data-src="../images/mas/TD_iPhone_Air_4.png" /></p>
<p><span style="font-size: xx-small;float:right">Foto von
<a href="https://de.ifixit.com/News/113356/das-duennste-iphone-von-apple-haelt-reparaturen-stand">iFixit</a></span></p>
</div>
</section>
<section class="slide level3">

<ul>
<li>Das Fehlen dieser Maßnahmen stellt nicht von sich aus eine
Schwachstelle dar.</li>
<li>Resilienzmaßnahmen bieten zusätzlichen Schutz gegen
bedrohungsspezifische Angriffe.</li>
</ul>
</section>
<section id="geschäftliche-perspektive" class="slide level3">
<h3>Geschäftliche Perspektive</h3>
<p>Hilft, Risiken zu mindern wie:</p>
<ul>
<li>Diebstahl oder Kompromittierung von proprietären Algorithmen,
Geschäftsgeheimnissen, Kundendaten, KI- oder
Machine-Learning-Modellen</li>
<li>Betrug, Schummeln oder Umsatzverlust in Online-Spielen, Finanz-Apps
oder Abomodellen</li>
<li>Rechtliche und reputationsschädigende Folgen aufgrund von Vertrags-
oder Regelverstößen</li>
<li>Schädigung des Markenimages durch negative Publicity oder
Unzufriedenheit der Kunden</li>
</ul>
</section>
<section id="transparenz-und-offene-prüfperspektive"
class="slide level3">
<h3>Transparenz und offene Prüfperspektive</h3>
<p>In einigen Kontexten, wie z.B. bei Regierungs-, Gesundheits- oder
anderen Anwendungen von öffentlichem Interesse, sind Resilienzmaßnahmen
möglicherweise aus mehreren Gründen nicht ideal:</p>
<ul>
<li>Sie verringern die Transparenz darüber, was die kompilierte
Anwendung tut.</li>
<li>Unabhängige Überprüfung der kompilierten Anwendung ist
schwieriger.</li>
<li>Die Vielfalt der OS kann durch false positives zum Ausschluss
legitimer Benutzer führen.</li>
</ul>
</section></section>
<section>
<section id="verification-controls" class="title-slide slide level2">
<h2>Verification Controls</h2>

</section>
<section id="masvs-resilience-1" class="slide level3">
<h3>MASVS-RESILIENCE-1</h3>
<blockquote>
<p>The app validates the integrity of the platform.</p>
</blockquote>
</section>
<section id="masvs-resilience-2" class="slide level3">
<h3>MASVS-RESILIENCE-2</h3>
<blockquote>
<p>The app implements anti-tampering mechanisms.</p>
</blockquote>
</section>
<section id="masvs-resilience-3" class="slide level3">
<h3>MASVS-RESILIENCE-3</h3>
<blockquote>
<p>The app implements anti-static analysis mechanisms.</p>
</blockquote>
</section>
<section id="masvs-resilience-4" class="slide level3">
<h3>MASVS-RESILIENCE-4</h3>
<blockquote>
<p>The app implements anti-dynamic analysis techniques.</p>
</blockquote>
</section></section>
<section>
<section id="weakness-enumeration" class="title-slide slide level2">
<h2>Weakness Enumeration</h2>

</section>
<section id="masvs-resilience-1-1" class="slide level3">
<h3>MASVS-RESILIENCE-1</h3>
<p>L2</p>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0008">MASWE-0008</a>:
Missing Device Secure Lock Verification Implementation</li>
</ul>
</section>
<section class="slide level3">

<p>R</p>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0097">MASWE-0097</a>:
Root/Jailbreak Detection Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0098">MASWE-0098</a>:
App Virtualization Environment Detection Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0099">MASWE-0099</a>:
Emulator Detection Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0100">MASWE-0100</a>:
Device Attestation Not Implemented</li>
</ul>
</section>
<section id="masvs-resilience-2-1" class="slide level3">
<h3>MASVS-RESILIENCE-2</h3>
<p>R</p>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0104">MASWE-0104</a>:
App Integrity Not Verified</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0105">MASWE-0105</a>:
Integrity of App Resources Not Verified</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0106">MASWE-0106</a>:
Official Store Verification Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0107">MASWE-0107</a>:
Runtime Code Integrity Not Verified</li>
</ul>
</section>
<section id="masvs-resilience-3-1" class="slide level3">
<h3>MASVS-RESILIENCE-3</h3>
<p>R</p>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0089">MASWE-0089</a>:
Code Obfuscation Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0090">MASWE-0090</a>:
Resource Obfuscation Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0091">MASWE-0091</a>:
Anti-Deobfuscation Techniques Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0092">MASWE-0092</a>:
Static Analysis Tools Not Prevented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0093">MASWE-0093</a>:
Debugging Symbols Not Removed</li>
</ul>
</section>
<section class="slide level3">

<p>R</p>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0094">MASWE-0094</a>:
Non-Production Resources Not Removed</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0095">MASWE-0095</a>:
Code That Disables Security Controls Not Removed</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0096">MASWE-0096</a>:
Data Sent Unencrypted Over Encrypted Connections</li>
</ul>
</section>
<section id="masvs-resilience-4-1" class="slide level3">
<h3>MASVS-RESILIENCE-4</h3>
<ul>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0067">MASWE-0067</a>:
Debuggable Flag Not Disabled</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0101">MASWE-0101</a>:
Debugger Detection Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0102">MASWE-0102</a>:
Dynamic Analysis Tools Detection Not Implemented</li>
<li><a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0103">MASWE-0103</a>:
RASP Techniques Not Implemented</li>
</ul>
</section></section>
<section>
<section id="testing-guide" class="title-slide slide level2">
<h2>Testing Guide</h2>

</section>
<section id="masvs-resilience-1-2" class="slide level3">
<h3>MASVS-RESILIENCE-1</h3>
<p><img data-src="../images/graphviz/owaspresilience1.svg" /></p>
</section>
<section id="masvs-resilience-2-2" class="slide level3">
<h3>MASVS-RESILIENCE-2</h3>
<p><img data-src="../images/graphviz/owaspresilience2.svg" /></p>
</section>
<section id="masvs-resilience-3-2" class="slide level3">
<h3>MASVS-RESILIENCE-3</h3>
<p><img data-src="../images/graphviz/owaspresilience3.svg" /></p>
</section>
<section id="masvs-resilience-4-2" class="slide level3">
<h3>MASVS-RESILIENCE-4</h3>
<p><img data-src="../images/graphviz/owaspresilience4.svg" /></p>
</section></section>
<section>
<section id="beispiel-mastg-demo-0021" class="title-slide slide level2">
<h2>Beispiel MASTG-DEMO-0021</h2>

</section>
<section id="ausgangspunkt-demo" class="slide level3">
<h3>Ausgangspunkt Demo</h3>
<p>Demo <a
href="https://mas.owasp.org/MASTG/demos/ios/MASVS-RESILIENCE/MASTG-DEMO-0021/MASTG-DEMO-0021/">MASTG-DEMO-0021</a>
kann in Test <a
href="https://mas.owasp.org/MASTG/tests/ios/MASVS-RESILIENCE/MASTG-TEST-0240/">MASTG-TEST-0240</a>
genutzt werden. Dieser testet Weakness <a
href="https://mas.owasp.org/MASWE/MASVS-RESILIENCE/MASWE-0097/">MASWE-0097</a>
zu Control <a
href="https://mas.owasp.org/MASVS/controls/MASVS-RESILIENCE-1/">MASVS-RESILIENCE-1</a>.</p>
</section>
<section id="mastg-demo-0021" class="slide level3">
<h3>MASTG-DEMO-0021</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">SwiftUI</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MastgTest <span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static</span> <span class="kw">func</span> <span class="fu">mastgTest</span><span class="op">(</span><span class="va">completion</span><span class="op">:</span> @<span class="dt">escaping</span> (<span class="va">String</span><span class="op">)</span> -&gt; <span class="fu">Void</span>) <span class="op">{</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">jailbreakDetails</span> <span class="op">=</span> JailbreakDetector<span class="op">.</span>isDeviceJailbroken<span class="op">()</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        completion<span class="op">(</span>jailbreakDetails<span class="op">)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> JailbreakDetector <span class="op">{</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static</span> <span class="kw">func</span> <span class="fu">isDeviceJailbroken</span><span class="op">()</span> -&gt; <span class="fu">String</span> <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Check if running on a simulator</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> DeviceUtils<span class="op">.</span>isSimulator<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> <span class="va">simulatorName</span> <span class="op">=</span> ProcessInfo<span class="op">.</span>processInfo<span class="op">.</span>environment<span class="op">[</span><span class="st">&quot;SIMULATOR_DEVICE_NAME&quot;</span><span class="op">]</span> <span class="op">??</span> <span class="st">&quot;Unknown Simulator&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Warning: Running on a simulator (</span><span class="er">\(</span><span class="st">simulatorName)).</span><span class="sc">\n\n</span><span class="st">Proof:</span><span class="sc">\n\n</span><span class="st">&quot;</span> <span class="op">+</span> collectJailbreakProof<span class="op">()</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Collect jailbreak proofs</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">proof</span> <span class="op">=</span> collectJailbreakProof<span class="op">()</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> proof<span class="op">.</span>isEmpty <span class="op">{</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Jailbreak: False</span><span class="sc">\n\n</span><span class="st">No signs of a jailbreak detected.&quot;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Jailbreak: True</span><span class="sc">\n\n</span><span class="st">Proof:</span><span class="sc">\n\n</span><span class="st">&quot;</span> <span class="op">+</span> proof</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">static</span> <span class="kw">func</span> <span class="fu">collectJailbreakProof</span><span class="op">()</span> -&gt; <span class="fu">String</span> <span class="op">{</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> <span class="va">reasons</span> <span class="op">=</span> <span class="op">[</span>String<span class="op">]()</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Check 1: Common jailbreak files and directories</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">jailbreakPaths</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/Applications/Cydia.app&quot;</span><span class="op">,</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/Applications/Sileo.app&quot;</span><span class="op">,</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/Applications/Zebra.app&quot;</span><span class="op">,</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/Applications/Installer.app&quot;</span><span class="op">,</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/Library/MobileSubstrate/MobileSubstrate.dylib&quot;</span><span class="op">,</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/usr/libexec/cydia&quot;</span><span class="op">,</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/usr/libexec/ssh-keysign&quot;</span><span class="op">,</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/usr/sbin/sshd&quot;</span><span class="op">,</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/usr/bin/ssh&quot;</span><span class="op">,</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/var/cache/apt&quot;</span><span class="op">,</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/var/lib/apt&quot;</span><span class="op">,</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/var/lib/cydia&quot;</span><span class="op">,</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/var/log/syslog&quot;</span><span class="op">,</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/bin/bash&quot;</span><span class="op">,</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/bin/sh&quot;</span><span class="op">,</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/etc/apt&quot;</span><span class="op">,</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/private/var/lib/undecimus&quot;</span><span class="op">,</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/private/var/root/Library/PreferenceLoader/Preferences&quot;</span><span class="op">,</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/private/etc/apt&quot;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="op">]</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> path <span class="cf">in</span> jailbreakPaths <span class="op">{</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> FileManager<span class="op">.</span><span class="kw">default</span><span class="op">.</span>fileExists<span class="op">(</span>atPath<span class="op">:</span> path<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                reasons<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Detected jailbreak file or directory at </span><span class="er">\(</span><span class="st">path)&quot;</span><span class="op">)</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Check 2: Custom URL schemes</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">urlSchemes</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;cydia://&quot;</span><span class="op">,</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;sileo://&quot;</span><span class="op">,</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;zebra://&quot;</span><span class="op">,</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;filza://&quot;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="op">]</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> scheme <span class="cf">in</span> urlSchemes <span class="op">{</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">let</span> <span class="va">url</span> <span class="op">=</span> URL<span class="op">(</span>string<span class="op">:</span> scheme<span class="op">),</span> UIApplication<span class="op">.</span>shared<span class="op">.</span>canOpenURL<span class="op">(</span>url<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                reasons<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Able to open suspicious URL scheme: </span><span class="er">\(</span><span class="st">scheme)&quot;</span><span class="op">)</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Check 3: Suspicious environment variables</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">suspiciousEnvVars</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DYLD_INSERT_LIBRARIES&quot;</span><span class="op">,</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DYLD_FRAMEWORK_PATH&quot;</span><span class="op">,</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DYLD_LIBRARY_PATH&quot;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">]</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> envVar <span class="cf">in</span> suspiciousEnvVars <span class="op">{</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ProcessInfo<span class="op">.</span>processInfo<span class="op">.</span>environment<span class="op">[</span>envVar<span class="op">]</span> <span class="op">!=</span> <span class="kw">nil</span> <span class="op">{</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                reasons<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Suspicious environment variable detected: </span><span class="er">\(</span><span class="st">envVar)&quot;</span><span class="op">)</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Check 4: Write access to system paths</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="va">paths</span> <span class="op">=</span> <span class="op">[</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/private/jailbreak.txt&quot;</span><span class="op">,</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;/private/var/mobile/Library/jailbreak.txt&quot;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>        <span class="op">]</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> path <span class="cf">in</span> paths <span class="op">{</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span> <span class="st">&quot;test&quot;</span><span class="op">.</span>write<span class="op">(</span>toFile<span class="op">:</span> path<span class="op">,</span> atomically<span class="op">:</span> <span class="kw">true</span><span class="op">,</span> encoding<span class="op">:</span> <span class="op">.</span>utf8<span class="op">)</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span> FileManager<span class="op">.</span><span class="kw">default</span><span class="op">.</span>removeItem<span class="op">(</span>atPath<span class="op">:</span> path<span class="op">)</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                reasons<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Write access detected at </span><span class="er">\(</span><span class="st">path)&quot;</span><span class="op">)</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> reasons<span class="op">.</span>joined<span class="op">(</span>separator<span class="op">:</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DeviceUtils <span class="op">{</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">static</span> <span class="kw">func</span> <span class="fu">isSimulator</span><span class="op">()</span> -&gt; <span class="fu">Bool</span> <span class="op">{</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> ProcessInfo<span class="op">.</span>processInfo<span class="op">.</span>environment<span class="op">[</span><span class="st">&quot;SIMULATOR_DEVICE_NAME&quot;</span><span class="op">]</span> <span class="op">!=</span> <span class="kw">nil</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="weakness-und-control" class="slide level3">
<h3>Weakness und Control</h3>
<p>MASWE-0097</p>
<blockquote>
<p>Root/Jailbreak Detection Not Implemented</p>
</blockquote>
<p>MASVS-RESILIENCE-1</p>
<blockquote>
<p>The app validates the integrity of the platform.</p>
</blockquote>
</section>
<section id="mastg-test-0200" class="slide level3">
<h3>MASTG-TEST-0200</h3>
<p>Run a static analysis tool such as <a
href="https://github.com/radareorg/radare2">radare2</a> for iOS on the
app binary looking for common jailbreak detection checks.</p>
</section>
<section id="radare-script" class="slide level3">
<h3>Radare Script</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>e asm<span class="op">.</span>bytes<span class="op">=</span>false</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>e scr<span class="op">.</span>color<span class="op">=</span>false</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>e asm<span class="op">.</span>var<span class="op">=</span>false</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>?e search for jailbreak path<span class="op">:</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>/ /Applications<span class="op">/</span>Cydia<span class="op">.</span>app</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>/ /Applications<span class="op">/</span>Sileo<span class="op">.</span>app</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>/ /Applications<span class="op">/</span>Zebra<span class="op">.</span>app</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>/ /usr<span class="op">/</span>sbin<span class="op">/</span>sshd</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>/ /usr<span class="op">/</span>bin<span class="op">/</span>ssh</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>/ /var<span class="op">/</span>cache<span class="op">/</span>apt</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>/ /var<span class="op">/</span>lib<span class="op">/</span>apt</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>/ /var<span class="op">/</span>lib<span class="op">/</span>cydia</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>/ /var<span class="op">/</span>log<span class="op">/</span>syslog</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>/ /bin<span class="op">/</span>bash</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>/ /bin<span class="op">/</span>sh</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>/ /etc<span class="op">/</span>apt</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>/ /private<span class="op">/</span>jailbreak<span class="op">.</span>txt</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>/ /private<span class="op">/</span>var<span class="op">/</span>mobile<span class="op">/</span>Library<span class="op">/</span>jailbreak<span class="op">.</span>txt</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>?e search for urlSchemes<span class="op">:</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>/ cydia<span class="op">://</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>/ sileo<span class="op">://</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>/ zebra<span class="op">://</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>/ filza<span class="op">://</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>?e search for suspiciousEnvVars<span class="op">:</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>/ DYLD_INSERT_LIBRARIES</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>/ DYLD_FRAMEWORK_PATH</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>/ DYLD_LIBRARY_PATH</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>?e Searching for Jailbreak output<span class="op">:</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>iz<span class="op">~+</span>jail</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>?e xrefs to Jailbreak strings<span class="op">:</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>axt <span class="bn">0x10011db00</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>?e</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>?e Disassembled Jailbreak function<span class="op">:</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>pdf <span class="fu">@</span><span class="er"> </span><span class="bn">0x100008c14</span></span></code></pre></div>
</section>
<section id="ergebnis" class="slide level3">
<h3>Ergebnis</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>search for jailbreak path<span class="op">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>0x10011d850 hit4_0 <span class="st">&quot;4/Applications/Cydia.app/Applic&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>0x10011d870 hit5_0 <span class="st">&quot;dia.app/Applications/Sileo.app/Applic&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>0x10011d890 hit6_0 <span class="st">&quot;leo.app/Applications/Zebra.app/Applic&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>0x1001a0d68 hit7_0 <span class="st">&quot;@/usr/sbin/sshd/usr/bin/ssh&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>0x1001a0d78 hit8_0 <span class="st">&quot;/usr/sbin/sshd/usr/bin/ssh/var/cache/a&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>0x1001a0d88 hit9_0 <span class="st">&quot;/usr/bin/ssh/var/cache/apt/var/lib/apt&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>0x1001a0d98 hit10_0 <span class="st">&quot;/var/cache/apt/var/lib/apt/var/lib/cyd&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>0x1001a0da8 hit11_0 <span class="st">&quot;/var/lib/apt/var/lib/cydia/var/log/syslo&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>0x1001a0db8 hit12_0 <span class="st">&quot;/var/lib/cydia/var/log/syslog/bin/bash&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>0x1001a0dc8 hit13_0 <span class="st">&quot;/var/log/syslog/bin/bash/bin/sh&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>0x1001a0dd8 hit14_0 <span class="st">&quot;/bin/bash/bin/sh/etc/ap&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>0x1001a0de8 hit15_0 <span class="st">&quot;/bin/sh/etc/apt&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>0x10011d9a8 hit15_1 <span class="st">&quot;/private/etc/apt&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>0x10011da20 hit16_0 <span class="st">&quot;H/private/jailbreak.txt/priva&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>0x10011da40 hit17_0 <span class="st">&quot;ak.txt/private/var/mobile/Library/jailbreak.txt_TtC10MAS&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>search for urlSchemes<span class="op">:</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>0x1001a0e50 hit18_0 <span class="st">&quot;cydia://sileo://&quot;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>0x1001a0e60 hit19_0 <span class="st">&quot;cydia://sileo://zebra://&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>0x1001a0e70 hit20_0 <span class="st">&quot;sileo://zebra://filza://&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>0x1001a0e80 hit21_0 <span class="st">&quot;zebra://filza://&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>search for suspiciousEnvVars<span class="op">:</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>0x10011d9c0 hit22_0 <span class="st">&quot;DYLD_INSERT_LIBRARIESDYLD_&quot;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>0x10011d9e0 hit23_0 <span class="st">&quot;ARIESDYLD_FRAMEWORK_PATHDYL&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>0x10011da00 hit24_0 <span class="st">&quot;ATHDYLD_LIBRARY_PATH/&quot;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>Searching for Jailbreak output<span class="op">:</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>13   0x0011da20  0x10011da20 22  23   4.__TEXT<span class="op">.</span>__cstring         ascii   <span class="op">/</span>private<span class="op">/</span>jailbreak<span class="op">.</span>txt</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>14   0x0011da40  0x10011da40 41  42   4.__TEXT<span class="op">.</span>__cstring         ascii   <span class="op">/</span>private<span class="op">/</span>var<span class="op">/</span>mobile<span class="op">/</span>Library<span class="op">/</span>jailbreak<span class="op">.</span>txt</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>16   0x0011da90  0x10011da90 35  36   4.__TEXT<span class="op">.</span>__cstring         ascii   _TtC10MASTestApp17JailbreakDetector</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>19   0x0011db00  0x10011db00 25  26   4.__TEXT<span class="op">.</span>__cstring         ascii   Jailbreak<span class="op">:</span> True<span class="op">\</span>n<span class="op">\</span>nProof<span class="op">:\</span>n<span class="op">\</span>n</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>20   0x0011db20  0x10011db20 51  52   4.__TEXT<span class="op">.</span>__cstring         ascii   Jailbreak<span class="op">:</span> False<span class="op">\</span>n<span class="op">\</span>nNo signs of a jailbreak detected<span class="op">.</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>26   0x0011dc30  0x10011dc30 40  41   4.__TEXT<span class="op">.</span>__cstring         ascii   Detected jailbreak <span class="dt">file</span> <span class="op">or</span> directory at </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>2    0x00134020  0x100134020 17  18   5.__TEXT<span class="op">.</span>__const           ascii   JailbreakDetector</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>xrefs to Jailbreak strings<span class="op">:</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>sym<span class="op">.</span>func<span class="op">.</span><span class="dv">100008</span><span class="er">c14</span> <span class="bn">0x100008dc8</span> <span class="op">[</span>STRN<span class="op">:-</span>w<span class="op">-]</span> add x9<span class="op">,</span> x9<span class="op">,</span> str<span class="op">.</span>Jailbreak<span class="op">:</span>_True_n_nProof<span class="op">:</span>_n_n</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>Disassembled Jailbreak function<span class="op">:</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">; CALL XREF from sym.func.100009ef8 @ 0x100009f28(x)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>┌ 724: sym<span class="op">.</span>func<span class="op">.</span><span class="dv">100008</span><span class="er">c14</span> <span class="op">(</span>int64_t arg_0h<span class="op">,</span> int64_t arg_60h<span class="op">,</span> void <span class="op">*</span>arg0<span class="op">)</span><span class="co">;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>│           0x100008c14      <span class="bu">sub</span> <span class="kw">sp</span><span class="op">,</span> <span class="kw">sp</span><span class="op">,</span> <span class="bn">0x60</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>│           0x100008c18      stp x26<span class="op">,</span> x25<span class="op">,</span> <span class="op">[</span>var_10h<span class="op">]</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>│           0x100008c1c      stp x24<span class="op">,</span> x23<span class="op">,</span> <span class="op">[</span>var_20h<span class="op">]</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>│           0x100008c20      stp x22<span class="op">,</span> x21<span class="op">,</span> <span class="op">[</span>var_30h<span class="op">]</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>│           0x100008c24      stp x20<span class="op">,</span> x19<span class="op">,</span> <span class="op">[</span>var_40h<span class="op">]</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>│           0x100008c28      stp x29<span class="op">,</span> x30<span class="op">,</span> <span class="op">[</span>var_50h<span class="op">]</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>│           0x100008c2c      <span class="bu">add</span> x29<span class="op">,</span> var_50h</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>│           0x100008c30      movz x22<span class="op">,</span> <span class="bn">0x11</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>│           0x100008c34      movk x22<span class="op">,</span> <span class="bn">0xd000</span><span class="op">,</span> lsl <span class="dv">48</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>│           0x100008c38      adrp x8<span class="op">,</span> segment<span class="op">.</span>__DATA                   <span class="co">; 0x1001a0000</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>│           0x100008c3c      ldr x0<span class="op">,</span> <span class="op">[</span>x8<span class="op">,</span> <span class="bn">0xbe0</span><span class="op">]</span>                       <span class="co">; 0xcf ; 207 ; void *arg0</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>│           0x100008c40      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_opt_self                  <span class="co">; void *objc_opt_self(void *arg0)</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>│           0x100008c44      <span class="bu">mov</span> x19<span class="op">,</span> x0</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>│           0x100008c48      adrp x23<span class="op">,</span> segment<span class="op">.</span>__DATA                  <span class="co">; 0x1001a0000</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>│           0x100008c4c      ldr x1<span class="op">,</span> <span class="op">[</span>x23<span class="op">,</span> <span class="bn">0xba0</span><span class="op">]</span>                      <span class="co">; 0xde ; 222 ; char *selector</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>│           0x100008c50      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_msgSend                   <span class="co">; void *objc_msgSend(void *instance, char *selector)</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>│           0x100008c54      <span class="bu">mov</span> x29<span class="op">,</span> x29</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>│           0x100008c58      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_retainAutoreleasedReturnValue <span class="co">; void objc_retainAutoreleasedReturnValue(void *instance)</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>│           0x100008c5c      <span class="bu">mov</span> x20<span class="op">,</span> x0</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>│           0x100008c60      adrp x24<span class="op">,</span> segment<span class="op">.</span>__DATA                  <span class="co">; 0x1001a0000</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>│           0x100008c64      ldr x1<span class="op">,</span> <span class="op">[</span>x24<span class="op">,</span> <span class="bn">0xba8</span><span class="op">]</span>                      <span class="co">; 0xdf ; 223 ; char *selector</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>│           0x100008c68      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_msgSend                   <span class="co">; void *objc_msgSend(void *instance, char *selector)</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>│           0x100008c6c      <span class="bu">mov</span> x29<span class="op">,</span> x29</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>│           0x100008c70      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_retainAutoreleasedReturnValue <span class="co">; void objc_retainAutoreleasedReturnValue(void *instance)</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>│           0x100008c74      <span class="bu">mov</span> x21<span class="op">,</span> x0</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>│           0x100008c78      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *instance</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>│           0x100008c7c      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_release                   <span class="co">; void objc_release(void *instance)</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>│           0x100008c80      adrp x1<span class="op">,</span> reloc<span class="op">.</span>associated_conformance_descriptor_for_Foundation<span class="op">.</span>DataProtocol<span class="op">.</span>Swift<span class="op">.</span>Collection<span class="op">.</span>SubSequence<span class="op">:</span>_Foundation<span class="op">.</span>DataProtocol <span class="co">; 0x100188000</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>│           0x100008c84      ldr x1<span class="op">,</span> <span class="op">[</span>x1<span class="op">,</span> <span class="bn">0x890</span><span class="op">]</span>                       <span class="co">; 0xc8 ; 200</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>│           0x100008c88      adrp x3<span class="op">,</span> reloc<span class="op">.</span>associated_conformance_descriptor_for_Foundation<span class="op">.</span>DataProtocol<span class="op">.</span>Swift<span class="op">.</span>Collection<span class="op">.</span>SubSequence<span class="op">:</span>_Foundation<span class="op">.</span>DataProtocol <span class="co">; 0x100188000</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>│           0x100008c8c      ldr x3<span class="op">,</span> <span class="op">[</span>x3<span class="op">,</span> <span class="bn">0x898</span><span class="op">]</span>                       <span class="co">; 0xca ; 202</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>│           0x100008c90      <span class="bu">mov</span> x0<span class="op">,</span> x21</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>│           0x100008c94      <span class="bu">mov</span> x2<span class="op">,</span> x1</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>│           0x100008c98      bl sym static <span class="op">(</span>extension in Foundation<span class="op">):</span>Swift<span class="op">.</span>Dictionary<span class="op">.</span>_unconditionallyBridgeFromObjectiveC<span class="op">(</span>Swift<span class="op">.</span>Optional<span class="op">&lt;</span>__C<span class="op">.</span>NSDictionary<span class="op">&gt;)</span> <span class="op">-&gt;</span> Swift<span class="op">.</span>Dictionary<span class="op">&lt;</span>A<span class="op">,</span> B<span class="op">&gt;</span> <span class="co">; sym.imp.static__extension_in_Foundation_:Swift.Dictionary._unconditionallyBridgeFromObjectiveC_Swift.Optional___C.NSDictionary______Swift.Dictionary_A__B_</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>│           0x100008c9c      <span class="bu">mov</span> x20<span class="op">,</span> x0</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>│           0x100008ca0      <span class="bu">mov</span> x0<span class="op">,</span> x21                               <span class="co">; void *instance</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>│           0x100008ca4      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_release                   <span class="co">; void objc_release(void *instance)</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>│           0x100008ca8      ldr x8<span class="op">,</span> <span class="op">[</span>x20<span class="op">,</span> <span class="bn">0x10</span><span class="op">]</span>                       <span class="co">; 0xdb ; 219</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>│       ┌─&lt; 0x100008cac      cbz x8<span class="op">,</span> <span class="bn">0x100008d9c</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cb0      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cb4      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRetain       <span class="co">; void *swift_bridgeObjectRetain(void *arg0)</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cb8      <span class="bu">add</span> x0<span class="op">,</span> x22<span class="op">,</span> <span class="dv">4</span>                            <span class="co">; int64_t arg1</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cbc      adrp x8<span class="op">,</span> sym<span class="op">.</span>imp<span class="op">.</span>__error                  <span class="co">; 0x10011d000</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cc0      <span class="bu">add</span> x8<span class="op">,</span> x8<span class="op">,</span> <span class="bn">0xae0</span>                         <span class="co">; 0x10011dae0 ; &quot;SIMULATOR_DEVICE_NAME&quot;</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cc4      <span class="bu">sub</span> x25<span class="op">,</span> x8<span class="op">,</span> <span class="bn">0x20</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cc8      orr x1<span class="op">,</span> x25<span class="op">,</span> <span class="bn">0x8000000000000000</span>           <span class="co">; int64_t arg2</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>│       │   0x100008ccc      bl sym<span class="op">.</span>func<span class="op">.</span><span class="dv">100008070</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cd0      <span class="bu">mov</span> x21<span class="op">,</span> x1</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cd4      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>│       │   0x100008cd8      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>│      ┌──&lt; 0x100008cdc      tbz w21<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x100008d9c</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ce0      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ce4      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ce8      ldr x1<span class="op">,</span> <span class="op">[</span>x23<span class="op">,</span> <span class="bn">0xba0</span><span class="op">]</span>                      <span class="co">; 0xde ; 222 ; char *selector</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008cec      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *instance</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008cf0      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_msgSend                   <span class="co">; void *objc_msgSend(void *instance, char *selector)</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008cf4      <span class="bu">mov</span> x29<span class="op">,</span> x29</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008cf8      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_retainAutoreleasedReturnValue <span class="co">; void objc_retainAutoreleasedReturnValue(void *instance)</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008cfc      <span class="bu">mov</span> x19<span class="op">,</span> x0</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d00      ldr x1<span class="op">,</span> <span class="op">[</span>x24<span class="op">,</span> <span class="bn">0xba8</span><span class="op">]</span>                      <span class="co">; 0xdf ; 223 ; char *selector</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d04      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_msgSend                   <span class="co">; void *objc_msgSend(void *instance, char *selector)</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d08      <span class="bu">mov</span> x29<span class="op">,</span> x29</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d0c      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_retainAutoreleasedReturnValue <span class="co">; void objc_retainAutoreleasedReturnValue(void *instance)</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d10      <span class="bu">mov</span> x21<span class="op">,</span> x0</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d14      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *instance</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d18      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_release                   <span class="co">; void objc_release(void *instance)</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d1c      adrp x1<span class="op">,</span> reloc<span class="op">.</span>associated_conformance_descriptor_for_Foundation<span class="op">.</span>DataProtocol<span class="op">.</span>Swift<span class="op">.</span>Collection<span class="op">.</span>SubSequence<span class="op">:</span>_Foundation<span class="op">.</span>DataProtocol <span class="co">; 0x100188000</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d20      ldr x1<span class="op">,</span> <span class="op">[</span>x1<span class="op">,</span> <span class="bn">0x890</span><span class="op">]</span>                       <span class="co">; 0xc8 ; 200</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d24      adrp x3<span class="op">,</span> reloc<span class="op">.</span>associated_conformance_descriptor_for_Foundation<span class="op">.</span>DataProtocol<span class="op">.</span>Swift<span class="op">.</span>Collection<span class="op">.</span>SubSequence<span class="op">:</span>_Foundation<span class="op">.</span>DataProtocol <span class="co">; 0x100188000</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d28      ldr x3<span class="op">,</span> <span class="op">[</span>x3<span class="op">,</span> <span class="bn">0x898</span><span class="op">]</span>                       <span class="co">; 0xca ; 202</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d2c      <span class="bu">mov</span> x0<span class="op">,</span> x21</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d30      <span class="bu">mov</span> x2<span class="op">,</span> x1</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d34      bl sym static <span class="op">(</span>extension in Foundation<span class="op">):</span>Swift<span class="op">.</span>Dictionary<span class="op">.</span>_unconditionallyBridgeFromObjectiveC<span class="op">(</span>Swift<span class="op">.</span>Optional<span class="op">&lt;</span>__C<span class="op">.</span>NSDictionary<span class="op">&gt;)</span> <span class="op">-&gt;</span> Swift<span class="op">.</span>Dictionary<span class="op">&lt;</span>A<span class="op">,</span> B<span class="op">&gt;</span> <span class="co">; sym.imp.static__extension_in_Foundation_:Swift.Dictionary._unconditionallyBridgeFromObjectiveC_Swift.Optional___C.NSDictionary______Swift.Dictionary_A__B_</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d38      <span class="bu">mov</span> x20<span class="op">,</span> x0</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d3c      <span class="bu">mov</span> x0<span class="op">,</span> x21                               <span class="co">; void *instance</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d40      bl sym<span class="op">.</span>imp<span class="op">.</span>objc_release                   <span class="co">; void objc_release(void *instance)</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d44      ldr x8<span class="op">,</span> <span class="op">[</span>x20<span class="op">,</span> <span class="bn">0x10</span><span class="op">]</span>                       <span class="co">; 0xdb ; 219</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d48      adrp x9<span class="op">,</span> sym<span class="op">.</span>imp<span class="op">.</span>__error                  <span class="co">; 0x10011d000</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d4c      <span class="bu">add</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0xb60</span>                         <span class="co">; 0x10011db60 ; &quot;Unknown Simulator&quot;</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d50      <span class="bu">sub</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x20</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008d54      orr x19<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x8000000000000000</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>│     ┌───&lt; 0x100008d58      cbz x8<span class="op">,</span> <span class="bn">0x100008e0c</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d5c      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d60      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRetain       <span class="co">; void *swift_bridgeObjectRetain(void *arg0)</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d64      <span class="bu">add</span> x0<span class="op">,</span> x22<span class="op">,</span> <span class="dv">4</span>                            <span class="co">; int64_t arg1</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d68      orr x1<span class="op">,</span> x25<span class="op">,</span> <span class="bn">0x8000000000000000</span>           <span class="co">; int64_t arg2</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d6c      bl sym<span class="op">.</span>func<span class="op">.</span><span class="dv">100008070</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d70      movz x21<span class="op">,</span> <span class="bn">0x11</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d74      movk x21<span class="op">,</span> <span class="bn">0xd000</span><span class="op">,</span> lsl <span class="dv">48</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>│    ┌────&lt; 0x100008d78      tbz w1<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x100008d90</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>│    ││││   0x100008d7c      ldr x8<span class="op">,</span> <span class="op">[</span>x20<span class="op">,</span> <span class="bn">0x38</span><span class="op">]</span>                       <span class="co">; 0xdb ; 219</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>│    ││││   0x100008d80      <span class="bu">add</span> x8<span class="op">,</span> x8<span class="op">,</span> x0<span class="op">,</span> lsl <span class="dv">4</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>│    ││││   0x100008d84      ldp x21<span class="op">,</span> x19<span class="op">,</span> <span class="op">[</span>x8<span class="op">]</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>│    ││││   0x100008d88      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *arg0</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>│    ││││   0x100008d8c      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRetain       <span class="co">; void *swift_bridgeObjectRetain(void *arg0)</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>│    └────&gt; 0x100008d90      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>│     │││   0x100008d94      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>│    ┌────&lt; 0x100008d98      b <span class="bn">0x100008e14</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>│    ││└└─&gt; 0x100008d9c      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008da0      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008da4      bl sym<span class="op">.</span>func<span class="op">.</span><span class="dv">1000082</span><span class="er">b4</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008da8      <span class="bu">mov</span> x19<span class="op">,</span> x1</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008dac      ubfx x8<span class="op">,</span> x1<span class="op">,</span> <span class="bn">0x38</span><span class="op">,</span> <span class="dv">4</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008db0      <span class="bu">and</span> x9<span class="op">,</span> x0<span class="op">,</span> <span class="bn">0xffffffffffff</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008db4      tst x1<span class="op">,</span> <span class="bn">0x2000000000000000</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>│    ││     0x100008db8      csel x8<span class="op">,</span> x9<span class="op">,</span> x8<span class="op">,</span> eq</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>│    ││ ┌─&lt; 0x100008dbc      cbz x8<span class="op">,</span> <span class="bn">0x100008dec</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dc0      <span class="bu">add</span> x8<span class="op">,</span> x22<span class="op">,</span> <span class="dv">8</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dc4      adrp x9<span class="op">,</span> sym<span class="op">.</span>imp<span class="op">.</span>__error                  <span class="co">; 0x10011d000</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dc8      <span class="bu">add</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0xb00</span>                         <span class="co">; 0x10011db00 ; &quot;Jailbreak: True\n\nProof:\n\n&quot;</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dcc      <span class="bu">sub</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x20</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dd0      orr x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x8000000000000000</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dd4      stp x8<span class="op">,</span> x9<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008dd8      <span class="bu">mov</span> x20<span class="op">,</span> <span class="kw">sp</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008ddc      <span class="bu">mov</span> x1<span class="op">,</span> x19</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008de0      bl sym Swift<span class="op">.</span>String<span class="op">.</span>append<span class="op">(</span>Swift<span class="op">.</span>String<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">()</span> <span class="co">; sym.imp.Swift.String.append_Swift.String_______</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>│    ││ │   0x100008de4      <span class="bu">mov</span> x0<span class="op">,</span> x19</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>│    ││┌──&lt; 0x100008de8      b <span class="bn">0x100008ec4</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>│    │││└─&gt; 0x100008dec      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *arg0</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008df0      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008df4      <span class="bu">add</span> x0<span class="op">,</span> x22<span class="op">,</span> <span class="bn">0x22</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008df8      adrp x8<span class="op">,</span> sym<span class="op">.</span>imp<span class="op">.</span>__error                  <span class="co">; 0x10011d000</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008dfc      <span class="bu">add</span> x8<span class="op">,</span> x8<span class="op">,</span> <span class="bn">0xb20</span>                         <span class="co">; 0x10011db20 ; &quot;Jailbreak: False\n\nNo signs of a jailbreak detected.&quot;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008e00      <span class="bu">sub</span> x8<span class="op">,</span> x8<span class="op">,</span> <span class="bn">0x20</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>│    │││    0x100008e04      orr x1<span class="op">,</span> x8<span class="op">,</span> <span class="bn">0x8000000000000000</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>│    │││┌─&lt; 0x100008e08      b <span class="bn">0x100008ecc</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>│    │└───&gt; 0x100008e0c      movz x21<span class="op">,</span> <span class="bn">0x11</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>│    │ ││   0x100008e10      movk x21<span class="op">,</span> <span class="bn">0xd000</span><span class="op">,</span> lsl <span class="dv">48</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>│    │ ││   <span class="co">; CODE XREF from sym.func.100008c14 @ 0x100008d98(x)</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>│    └────&gt; 0x100008e14      <span class="bu">mov</span> x0<span class="op">,</span> x20                               <span class="co">; void *arg0</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e18      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e1c      movz x8<span class="op">,</span> <span class="bn">0xe000</span><span class="op">,</span> lsl <span class="dv">48</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e20      stp xzr<span class="op">,</span> x8<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e24      <span class="bu">mov</span> x20<span class="op">,</span> <span class="kw">sp</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e28      movz w0<span class="op">,</span> <span class="bn">0x2f</span>                             <span class="co">; &#39;/&#39;</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e2c      bl sym Swift<span class="op">.</span>_StringGuts<span class="op">.</span>grow<span class="op">(</span>Swift<span class="op">.</span>Int<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">()</span> <span class="co">; sym.imp.Swift._StringGuts.grow_Swift.Int_______</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e30      ldr x0<span class="op">,</span> <span class="op">[</span>arg0<span class="op">]</span>                            <span class="co">; 0x4 ; 4 ; void *arg0</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e34      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e38      <span class="bu">add</span> x8<span class="op">,</span> x22<span class="op">,</span> <span class="bn">0x10</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e3c      adrp x9<span class="op">,</span> sym<span class="op">.</span>imp<span class="op">.</span>__error                  <span class="co">; 0x10011d000</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e40      <span class="bu">add</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0xb80</span>                         <span class="co">; 0x10011db80 ; &quot;Warning: Running on a simulator (&quot;</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e44      <span class="bu">sub</span> x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x20</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e48      orr x9<span class="op">,</span> x9<span class="op">,</span> <span class="bn">0x8000000000000000</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e4c      stp x8<span class="op">,</span> x9<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e50      <span class="bu">mov</span> x20<span class="op">,</span> <span class="kw">sp</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e54      <span class="bu">mov</span> x0<span class="op">,</span> x21</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e58      <span class="bu">mov</span> x1<span class="op">,</span> x19</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e5c      bl sym Swift<span class="op">.</span>String<span class="op">.</span>append<span class="op">(</span>Swift<span class="op">.</span>String<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">()</span> <span class="co">; sym.imp.Swift.String.append_Swift.String_______</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e60      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *arg0</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e64      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e68      <span class="bu">mov</span> x20<span class="op">,</span> <span class="kw">sp</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e6c      movz x0<span class="op">,</span> <span class="bn">0x2e29</span>                           <span class="co">; &#39;).&#39;</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e70      movk x0<span class="op">,</span> <span class="bn">0xa0a</span><span class="op">,</span> lsl <span class="dv">16</span>                    <span class="co">; &#39;\n\n&#39;</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e74      movk x0<span class="op">,</span> <span class="bn">0x7250</span><span class="op">,</span> lsl <span class="dv">32</span>                   <span class="co">; &#39;Pr&#39;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e78      movk x0<span class="op">,</span> <span class="bn">0x6f6f</span><span class="op">,</span> lsl <span class="dv">48</span>                   <span class="co">; &#39;oo&#39;</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e7c      movz x1<span class="op">,</span> <span class="bn">0x3a66</span>                           <span class="co">; &#39;f:&#39;</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e80      movk x1<span class="op">,</span> <span class="bn">0xa0a</span><span class="op">,</span> lsl <span class="dv">16</span>                    <span class="co">; &#39;\n\n&#39;</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e84      movk x1<span class="op">,</span> <span class="bn">0xec00</span><span class="op">,</span> lsl <span class="dv">48</span></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e88      bl sym Swift<span class="op">.</span>String<span class="op">.</span>append<span class="op">(</span>Swift<span class="op">.</span>String<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">()</span> <span class="co">; sym.imp.Swift.String.append_Swift.String_______</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e8c      ldp x20<span class="op">,</span> x19<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e90      bl sym<span class="op">.</span>func<span class="op">.</span><span class="dv">1000082</span><span class="er">b4</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e94      <span class="bu">mov</span> x21<span class="op">,</span> x0</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e98      <span class="bu">mov</span> x22<span class="op">,</span> x1</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008e9c      stp x20<span class="op">,</span> x19<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ea0      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *arg0</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ea4      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRetain       <span class="co">; void *swift_bridgeObjectRetain(void *arg0)</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ea8      <span class="bu">mov</span> x20<span class="op">,</span> <span class="kw">sp</span></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008eac      <span class="bu">mov</span> x0<span class="op">,</span> x21</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008eb0      <span class="bu">mov</span> x1<span class="op">,</span> x22</span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008eb4      bl sym Swift<span class="op">.</span>String<span class="op">.</span>append<span class="op">(</span>Swift<span class="op">.</span>String<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">()</span> <span class="co">; sym.imp.Swift.String.append_Swift.String_______</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008eb8      <span class="bu">mov</span> x0<span class="op">,</span> x19                               <span class="co">; void *arg0</span></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ebc      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>│      ││   0x100008ec0      <span class="bu">mov</span> x0<span class="op">,</span> x22</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>│      ││   <span class="co">; CODE XREF from sym.func.100008c14 @ 0x100008de8(x)</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>│      └──&gt; 0x100008ec4      bl sym<span class="op">.</span>imp<span class="op">.</span>swift_bridgeObjectRelease      <span class="co">; void swift_bridgeObjectRelease(void *arg0)</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>│       │   0x100008ec8      ldp x0<span class="op">,</span> x1<span class="op">,</span> <span class="op">[</span><span class="kw">sp</span><span class="op">]</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>│       │   <span class="co">; CODE XREF from sym.func.100008c14 @ 0x100008e08(x)</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>│       └─&gt; 0x100008ecc      ldp x29<span class="op">,</span> x30<span class="op">,</span> <span class="op">[</span>var_50h<span class="op">]</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>│           0x100008ed0      ldp x20<span class="op">,</span> x19<span class="op">,</span> <span class="op">[</span>var_40h<span class="op">]</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>│           0x100008ed4      ldp x22<span class="op">,</span> x21<span class="op">,</span> <span class="op">[</span>var_30h<span class="op">]</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>│           0x100008ed8      ldp x24<span class="op">,</span> x23<span class="op">,</span> <span class="op">[</span>var_20h<span class="op">]</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>│           0x100008edc      ldp x26<span class="op">,</span> x25<span class="op">,</span> <span class="op">[</span>var_10h<span class="op">]</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>│           0x100008ee0      <span class="bu">add</span> <span class="kw">sp</span><span class="op">,</span> arg_60h</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>└           0x100008ee4      <span class="cf">ret</span></span></code></pre></div>
</section></section>
<section>
<section id="beispiel-jailbreak-detection-flutter"
class="title-slide slide level2">
<h2>Beispiel Jailbreak Detection (Flutter)</h2>

</section>
<section id="flutter_jailbreak_detection" class="slide level3">
<h3><code>flutter_jailbreak_detection</code></h3>
<ul>
<li><code>flutter_jailbreak_detection</code> integriert typische
Mechanismen von iOS und Android</li>
<li>Beispielapp vorhanden in <a
href="https://github.com/jeroentrappers/flutter_jailbreak_detection/tree/master/example">GitHub</a></li>
<li>Code ist sehr einfach nutzbar</li>
</ul>
</section>
<section id="beispiel" class="slide level3">
<h3>Beispiel</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode dart"><code class="sourceCode dart"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="st">&#39;package:flutter_jailbreak_detection/flutter_jailbreak_detection.dart&#39;</span>;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="st">&#39;package:mas_test_app/demo_results.dart&#39;</span>;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MastgTest <span class="op">{</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span><span class="op">?</span> _jailbroken;</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span><span class="op">?</span> _developerMode;</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  DemoResults mastgTest() <span class="op">{</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    DemoResults r <span class="op">=</span> DemoResults(demoId<span class="op">:</span> <span class="st">&#39;0021&#39;</span>);</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      initPlatformState();</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      r<span class="op">.</span>add(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        Status<span class="op">.</span>pass<span class="op">,</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Jailbroken: $_jailbroken, Developer Mode: $_developerMode.&quot;</span><span class="op">,</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      );</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      r<span class="op">.</span>add(Status<span class="op">.</span>error<span class="op">,</span> e<span class="op">.</span>toString());</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> r;</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Platform messages are asynchronous, so we initialize in an async method.</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Future</span><span class="op">&lt;</span><span class="dt">void</span><span class="op">&gt;</span> initPlatformState() <span class="at">async</span> <span class="op">{</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> jailbroken;</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> developerMode;</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Platform messages may fail, so we use a try/catch PlatformException.</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      jailbroken <span class="op">=</span> <span class="at">await</span> FlutterJailbreakDetection<span class="op">.</span>jailbroken;</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      developerMode <span class="op">=</span> <span class="at">await</span> FlutterJailbreakDetection<span class="op">.</span>developerMode;</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">on</span> <span class="kw">Exception</span> <span class="op">{</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      jailbroken <span class="op">=</span> <span class="cn">true</span>;</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>      developerMode <span class="op">=</span> <span class="cn">true</span>;</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    _jailbroken <span class="op">=</span> jailbroken;</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    _developerMode <span class="op">=</span> developerMode;</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="test-ergebnis" class="slide level3">
<h3>Test-Ergebnis</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>search for jailbreak path<span class="op">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>search for urlSchemes<span class="op">:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>search for suspiciousEnvVars<span class="op">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Searching for Jailbreak output<span class="op">:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>7   0x00006b10  0x100006b10 31  32   5.__TEXT<span class="op">.</span>__cstring        ascii FlutterJailbreakDetectionPlugin</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>7   0x1000081a8 0x1000081a8 31  32                             ascii cstr<span class="op">.</span>FlutterJailbreakDetectionPlugin</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>xrefs to Jailbreak strings<span class="op">:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>Disassembled Jailbreak function<span class="op">:</span></span></code></pre></div>
</section></section>
<section>
<section id="beispiel---app-integrity-flutter"
class="title-slide slide level2">
<h2>Beispiel - App Integrity (Flutter)</h2>

</section>
<section id="maswe-0104-und-maswe-0106" class="slide level3">
<h3>MASWE-0104 und MASWE-0106</h3>
<p>MASWE-0104</p>
<blockquote>
<p>App Integrity Not Verified</p>
</blockquote>
<p>MASWE-0106</p>
<blockquote>
<p>Official Store Verification Not Implemented</p>
</blockquote>
<p>MASVS-RESILIENCE-2</p>
<blockquote>
<p>The app implements anti-tampering mechanisms.</p>
</blockquote>
</section>
<section id="app_integrity_checker" class="slide level3">
<h3>app_integrity_checker</h3>
<ul>
<li>Paket <a
href="https://pub.dev/packages/app_integrity_checker">app_integrity_checker</a>
kann Checksumme und Signatur auslesen</li>
<li>Beide Werte sind nicht stabil genug, um clientseitig geprüft werden
zu können</li>
<li>Serverseitige Überprüfung sinnvoll</li>
<li>Beispiel auf <a
href="https://github.com/romikavinda/app_integrity_checker/tree/main/example">GitHub</a></li>
<li>Korrigierte Version: <a
href="https://github.com/RobinNunkesser/dart-flutter-app-integrity">GitHub</a></li>
</ul>
</section>
<section id="ergebnis-1" class="slide level3">
<h3>Ergebnis</h3>
<p><img data-src="../images/mas/Screenshot_1763975792.png" /></p>
</section></section>
<section>
<section id="beispiel---talsec" class="title-slide slide level2">
<h2>Beispiel - Talsec</h2>

</section>
<section id="rasp" class="slide level3">
<h3>RASP</h3>
<ul>
<li>Talsec ist kommerzieller Anbieter von RASP+ und .freeRASP</li>
<li>Auch weitere für Flutter nützlicher Produkte</li>
<li>Fokus liegt hier auf kostenlosen Paketen</li>
</ul>
</section>
<section class="slide level3">

<p><img data-src="../images/mas/talsec.png" id="id" class="class"
height="570" /><br />
</p>
</section></section>
    </div>
  </div>

  <script src="reveal.js/dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="reveal.js/plugin/notes/notes.js"></script>
  <script src="reveal.js/plugin/search/search.js"></script>
  <script src="reveal.js/plugin/zoom/zoom.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // reveal.js plugins
        plugins: [
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
